### Документація для коду

Ось повна документація для наданого коду. Я написав її українською, структуровано, з описом функцій, класів та використання. Документація базується на коді, який я надав, і включає оновлення для твоїх вимог (PIN 4-6 цифр, оновлення курсів о 13:00, графіки як бар-чарт для простоти, PDF-експорт з email, бюджетування за категоріями, нотатки).

#### Огляд додатка

Це повний Android-додаток на Python з Kivy для відстеження фінансів: витрати, доходи, звіти, мультивалюта (UAH, USD, EUR з можливістю додавати), бюджетування, нагадування, експорт PDF, та простий нотатник. Додаток використовує SQLite для зберігання даних, ReportLab для PDF, Plyer для сповіщень та email, Kivy Garden для графіків.

**Ключові функції:**

- Авторизація: PIN 4-6 цифр (хешований з bcrypt).
- Витрати: Додавання/оновлення категорій з +/-, заборона негативних сум.
- Доходи: Записи з датою, сумою, описом.
- Звіти: Місячні тотали, топ-витрати, порівняння з попереднім місяцем, бар-графіки (вибрав бар, бо простіше в розробці та читабельніше для порівнянь; pie можеш додати сам).
- Валюти: Авто-оновлення курсів щодня після 13:00 за київським часом з API (exchangeratesapi.io – заміни YOUR_API_KEY на свій ключ).
- Бюджетування: Опціональне для кожної категорії (встанови ліміт, активуй, отримуй попередження при перевищенні).
- Нагадування: Авто-перевірка о 00:00 останнього дня місяця, сповіщення.
- Експорт: Генерація PDF-звіту з витратами, надсилання email (відкриває клієнт з прикріпленням) або скачування.
- Нотатки: Додавання/перегляд простих нотаток (з заголовком та змістом).
- Планування: Використовує schedule з київським часом (pytz 'Europe/Kyiv').

**Залежності:** kivy, kivy-garden.graph, reportlab, plyer, schedule, requests, bcrypt, pytz. Встанови: pip install <залежність>. Для графіків: garden install graph.

**Використання:**

- Запуск на ПК: python main.py.
- Компіляція для Android: buildozer android debug.
- Перший запуск: Встанови PIN.
- Навігація: Вкладки для Витрат, Доходів, Звітів, Нотаток, Налаштувань.

#### Структура коду

- **Імпорти:** Бібліотеки для бази, UI, часу, API тощо.
- **Налаштування бази:** Створення таблиць для витрат (з бюджетом), доходів, нотаток, валют, налаштувань.
- **Функції:**
    - get_current_month(): Повертає поточний місяць (e.g., "Жовтень 2025").
    - is_last_day_of_month(): Перевіряє, чи останній день місяця.
    - update_exchange_rates(): Оновлює курси валют з API після 13:00.
    - close_month_auto(): Авто-закриття місяця зі сповіщенням.
    - get_exchange_rate(), convert_currency(): Отримання/конвертація курсів (з fallback на ручний).
- **Класи UI:**
    - ExpenseRow: Рядок для списку витрат з кнопкою редагування бюджету.
    - ExpenseList: Список витрат (RecycleView).
    - ExpenseScreen: Екран витрат з формою (+/-, валюта), перевіркою бюджету.
    - IncomeScreen: Екран доходів (аналогічно).
    - ReportScreen: Екран звітів з генерацією, графіками (бар для топ-витрат), PDF-експортом.
    - NotesScreen: Екран нотаток з додаванням/переглядом.
    - SettingsScreen: Налаштування для додавання валют, ручного коригування.
    - LoginScreen: Авторизація з встановленням/перевіркою PIN (4-6 цифр, тільки цифри).
    - MainScreen: Головний таббар з вкладками.
    - FinanceApp: Головний клас додатка з ScreenManager.

#### Як додати функціонал

- **Додати валюту:** У налаштуваннях введи назву, вона додасться в базу та спіннер.
- **Ручне коригування курсу:** Додай popup в SettingsScreen для оновлення rate_to_uah.
- **Графіки:** Бар-чарт обраний для простоти (MeshLinePlot/BarPlot з Kivy Garden). Для pie: Додай SmoothLinePlot або кастомний.
- **PDF:** Генерується в корені, прикріплюється до email (Plyer відкриває клієнт). Для скачування: Використай filechooser.save_file().
- **Бюджет:** Активується per-категорія, сповіщення при перевищенні.
- **Обмеження:** База витримає тисячі записів; для оптимізації додай індекси в SQL.

#### Відомі обмеження

- Email: Відкриває системний клієнт, не надсилає автоматично.
- Графіки: Базові; для pie потрібно кастомізувати.
- API: Заміни YOUR_API_KEY на реальний (free на exchangeratesapi.io).
- Android: Plyer для сповіщень працює, але протестуй на пристрої.
- Немає хмарної синхронізації; дані локальні.